import{i as g}from"./common-BKi96IKK.js";function _(e,t){e.style.transform=t}class y{centered;circle;el;constructor(t,s,i){this.el=t,this.centered=s,this.circle=i}show(t,s){const{el:i}=this,{radius:o,scale:c,x:d,y:r,centerX:p,centerY:v}=this.calculate(t,s,i),l=document.createElement("span"),n=document.createElement("span");l.appendChild(n),l.className="v-ripple__container",n.className="v-ripple__animation";const m=`${o*2}px`;n.style.width=m,n.style.height=m,i.appendChild(l);const f=window.getComputedStyle(i);f&&f.position==="static"&&(i.style.position="relative",i.dataset.previousPosition="static"),n.classList.add("v-ripple__animation--enter"),n.classList.add("v-ripple__animation--visible"),_(n,`translate(${d}, ${r}) scale3d(${c},${c},${c})`),n.style.opacity="0",n.dataset.activated=String(performance.now()),setTimeout(()=>{n.classList.remove("v-ripple__animation--enter"),n.classList.add("v-ripple__animation--in"),n.style.opacity="0.1",_(n,`translate(${p}, ${v}) scale3d(1,1,1)`)})}hide(){const{el:t}=this,s=t.getElementsByClassName("v-ripple__animation");if(s.length===0)return;const i=s[s.length-1];if(i.dataset.isHiding)return;i.dataset.isHiding="true";const o=performance.now()-Number(i.dataset.activated),c=Math.max(250-o,0);setTimeout(()=>{i.classList.remove("v-ripple__animation--in"),i.classList.add("v-ripple__animation--out"),i.style.opacity="0",setTimeout(()=>{t.getElementsByClassName("v-ripple__animation").length===1&&t.dataset.previousPosition&&(t.style.position=t.dataset.previousPosition,delete t.dataset.previousPosition),i.parentNode&&t.removeChild(i.parentNode)},300)},c)}calculate(t,s,i){const o=i.getBoundingClientRect(),c=t-o.left,d=s-o.top;let r,p=.3;this.circle?(p=.15,r=i.clientWidth/2,r=this.centered?r:r+Math.sqrt((c-r)**2+(d-r)**2)/4):r=Math.sqrt(i.clientWidth**2+i.clientHeight**2)/2;const v=`${(i.clientWidth-r*2)/2}px`,l=`${(i.clientHeight-r*2)/2}px`,n=this.centered?v:`${c-r}px`,m=this.centered?l:`${d-r}px`;return{radius:r,scale:p,x:n,y:m,centerX:v,centerY:l}}}class L extends y{touched=!1;enabled=!0}function h(e){const t=e.currentTarget;if(!t?._ripple||t._ripple.touched)return;g(e)&&(t._ripple.touched=!0);const s=g(e)?e.touches[e.touches.length-1]:e;t._ripple.show(s.clientX,s.clientY)}function a(e){const t=e.currentTarget;if(!t)return;const{_ripple:s}=t;window.setTimeout(()=>{s&&(s.touched=!1)}),s?.enabled&&s.hide()}function E(e){e.addEventListener("touchstart",h,{passive:!0}),e.addEventListener("touchend",a,{passive:!0}),e.addEventListener("touchcancel",a),e.addEventListener("mousedown",h),e.addEventListener("mouseup",a),e.addEventListener("mouseleave",a),e.addEventListener("dragstart",a,{passive:!0})}function k(e){e.removeEventListener("touchstart",a),e.removeEventListener("touchend",a),e.removeEventListener("touchcancel",a),e.removeEventListener("mousedown",h),e.removeEventListener("mouseup",a),e.removeEventListener("mouseleave",a),e.removeEventListener("dragstart",a)}const w={beforeMount(e,t){const{centered:s,circle:i}=t.modifiers;e._ripple=new L(e,s,i),E(e)},unmounted(e){delete e._ripple,k(e)}},x={args:{centered:!1,circle:!1},argTypes:{circle:{control:{type:"boolean"}},centered:{control:{type:"boolean"}}}},u=e=>({data:()=>e,directives:{ripple:w},template:`
        <div v-if="centered && circle" :key="0" class="mock-dialog" v-ripple.centered.circle></div>
        <div v-else-if="circle" :key="1" class="mock-dialog" v-ripple.circle></div>
        <div v-else-if="centered" :key="2" class="mock-dialog" v-ripple.centered></div>
        <div v-else class="mock-dialog" :key="3" v-ripple></div>
    `});u.parameters={...u.parameters,docs:{...u.parameters?.docs,source:{originalSource:`args => ({
  data: () => args,
  directives: {
    ripple: vRipple
  },
  // 用 key 防止复用元素导致指令更新失败
  template: \`
        <div v-if="centered && circle" :key="0" class="mock-dialog" v-ripple.centered.circle></div>
        <div v-else-if="circle" :key="1" class="mock-dialog" v-ripple.circle></div>
        <div v-else-if="centered" :key="2" class="mock-dialog" v-ripple.centered></div>
        <div v-else class="mock-dialog" :key="3" v-ripple></div>
    \`
})`,...u.parameters?.docs?.source}}};const R=["Ripple"];export{u as Ripple,R as __namedExportsOrder,x as default};
